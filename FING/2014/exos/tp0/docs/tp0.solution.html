<!DOCTYPE html>

<html>
<head>
  <title>tp0.solution.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>tp0.solution.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="pr-liminaires">Préliminaires</h2>
<p>Vous pouvez effectuer tous les exercices de ce TP dans la console
interactive de votre navigateur.</p>
<p>Chaque fonction est accompagnée de tests (non exhaustifs) que vous
exécutez de la même façon.</p>
<p>Dans cette console vous pouvez taper du code JavaScript et
l’envoyer à l’interpréteur (touche <code>Entrée</code>) qui vous affiche la
valeur de retour de votre expression.</p>
<p>Pour écrire une expression sur plusieurs lignes, utilisez
<code>Shift+Entrée</code>.</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Test rapide, combien vaut cette expression ?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-number">1</span> * <span class="hljs-number">2.12</span> + <span class="hljs-number">3</span> / <span class="hljs-number">4e3</span> % <span class="hljs-number">5</span> + <span class="hljs-string">'6'</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="tour-de-chauffe">Tour de chauffe</h2>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Le premier mot clé à maîtriser est <code>var</code> pour déclarer une
variable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p><strong>Déclarez</strong> plusieurs variables dans la console, et assignez-leur
les valeurs qui vous chantent.  Des nombres, des chaînes de
caractères, d’autres variables …
Vous pouvez aussi les déclarer puis changer leur valeur dans un
second temps.</p>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2 id="func-fu">Func-fu</h2>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Les variables c’est bien utile, mais les fonctions encore plus !</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">square</span><span class="hljs-params">(x)</span> </span>{
  <span class="hljs-keyword">return</span> x * x;
}

square(<span class="hljs-number">12</span>) === <span class="hljs-number">144</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p><strong>Écrivez</strong> les fonctions suivantes, puis <strong>testez</strong>-les.</p>
<ul>
<li>x → x³</li>
<li>n → Fibonacci(n)</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cube</span><span class="hljs-params">(x)</span> </span>{
  <span class="hljs-keyword">return</span> x*x*x;
}

cube(<span class="hljs-number">3</span>) === <span class="hljs-number">27</span>; <span class="hljs-comment">//:</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fibo</span><span class="hljs-params">(n)</span> </span>{
  <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  <span class="hljs-keyword">return</span> fibo(n-<span class="hljs-number">1</span>) + fibo(n-<span class="hljs-number">2</span>);
}

fibo(<span class="hljs-number">0</span>) === <span class="hljs-number">1</span>; <span class="hljs-comment">//:</span>
fibo(<span class="hljs-number">1</span>) === <span class="hljs-number">1</span>; <span class="hljs-comment">//:</span>
fibo(<span class="hljs-number">2</span>) === <span class="hljs-number">2</span>; <span class="hljs-comment">//:</span>
fibo(<span class="hljs-number">3</span>) === <span class="hljs-number">3</span>; <span class="hljs-comment">//:</span>
fibo(<span class="hljs-number">10</span>) === <span class="hljs-number">89</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="-t-a-b-l-e-a-u-x-">[T,a,b,l,e,a,u,x]</h2>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Voici un tableau vide.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> array = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>On peut s’en servir comme une liste, et y ajouter des éléments (par
la queue).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>array.push(<span class="hljs-number">1</span>); array; <span class="hljs-comment">//:</span>
array.push(<span class="hljs-number">2</span>); array; <span class="hljs-comment">//:</span>
array.push(<span class="hljs-number">3</span>); array; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>… et en retirer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>array.pop(); array; <span class="hljs-comment">//:</span>
array.pop(); array; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Son attribut <code>length</code> reflète toujours sa longueur.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>array.length === <span class="hljs-number">1</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>L’égalité entre tableaux se fait par référence en JavaScript.
<strong>Écrivez</strong> la fonction <code>eq</code> qui retourne vrai si et seulement si
les deux tableaux passés en arguments sont des tableaux identiques.
On considère que les tableaux contiennent uniquement des nombres
(pas des tableaux).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eq</span><span class="hljs-params">(a, b)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; a.length; ++a)
    <span class="hljs-keyword">if</span> (a[i] !== b[i])
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

eq([], []) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span>
eq([<span class="hljs-number">1</span>], []) === <span class="hljs-literal">false</span>; <span class="hljs-comment">//:</span>
eq([<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>]) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span>
eq([[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-number">3</span>], [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-number">3</span>]); <span class="hljs-comment">// Non spécifié //:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>La fonction <code>accum</code> prend comme argument une fonction <code>fun</code> et un
entier <code>n</code>, et renvoie le tableau <code>[fun(0), fun(1), ..., fun(n)]</code>.
<strong>Écrivez</strong> cette fonction.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">accum</span><span class="hljs-params">(fun, n)</span> </span>{
  <span class="hljs-keyword">var</span> result = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt;= n; ++i)
    result.push(fun(i));
  <span class="hljs-keyword">return</span> result;
}

eq(accum(fibo, <span class="hljs-number">10</span>), [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">21</span>,<span class="hljs-number">34</span>,<span class="hljs-number">55</span>,<span class="hljs-number">89</span>]) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>La fonction <code>range</code> retourne le tableau [start, …, end-1] où
<code>start</code> et <code>end</code> sont des entiers.  Si un seul argument <code>start</code> est
passé à la fonction, alors elle retourne le tableau [0, …,
start-1].  <strong>Écrivez-la</strong>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">range</span><span class="hljs-params">(start, end)</span> </span>{
  <span class="hljs-keyword">if</span> (end == <span class="hljs-literal">null</span>) {
    end = start;
    start = <span class="hljs-number">0</span>;
  }

  <span class="hljs-keyword">if</span> (end &lt;= start) <span class="hljs-keyword">return</span> [];
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> range(start, end - <span class="hljs-number">1</span>).concat(end - <span class="hljs-number">1</span>);
}

eq(range(<span class="hljs-number">0</span>), []) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span>
eq(range(<span class="hljs-number">5</span>), [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span>
eq(range(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>), [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h2 id="-o-b-j-e-t-s-">{{{O}{{b}}}{j}{{e,t}{s}}}</h2>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Un objet peut être vu comme un tableau associatif, ou <em>map</em> en
anglais; une collection de pairs <code>(clé, valeur)</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> heroes = {
  <span class="hljs-string">'Tintin'</span>: {
    creator: <span class="hljs-string">'Hergé'</span>,
    likes: <span class="hljs-string">'Milou'</span>,
  },
  <span class="hljs-string">'Scrooge McDuck'</span>: {
    creator: <span class="hljs-string">'Carl Barks'</span>,
    likes: <span class="hljs-string">'Money'</span>,
  },
  <span class="hljs-string">'Batman'</span>: {
    creator: [<span class="hljs-string">'Bob Kane'</span>, <span class="hljs-string">'Bill Finger'</span>],
    likes: <span class="hljs-string">'Robin'</span>,
  },
};</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Les crochets permettent d’accéder à une propriété lorsque son nom
est contenu dans une variable (exactement comme l’indexation dans
un tableau).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFact</span><span class="hljs-params">(name, fact)</span> </span>{
  <span class="hljs-keyword">return</span> heroes[name][fact];
}

getFact(<span class="hljs-string">'Batman'</span>, <span class="hljs-string">'likes'</span>) === <span class="hljs-string">'Robin'</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p><strong>Écrivez</strong> la fonction <code>setFact</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setFact</span><span class="hljs-params">(name, fact, newFact)</span> </span>{
  heroes[name][fact] = newFact;
}

setFact(<span class="hljs-string">'Tintin'</span>, <span class="hljs-string">'likes'</span>, <span class="hljs-string">'Traveling'</span>); <span class="hljs-comment">//:</span>
heroes.Tintin.likes === <span class="hljs-string">'Traveling'</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p><strong>Écrivez</strong> la fonction <code>allFacts</code> qui retourne le tableau
contenant la valeur du fait <code>fact</code> pour chaque <code>hero</code> dans
<code>heroes</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">allFacts</span><span class="hljs-params">(fact)</span> </span>{
  <span class="hljs-keyword">var</span> facts = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> heroes)
    facts.push(getFact(name, fact));

  <span class="hljs-keyword">return</span> facts;
}

eq(allFacts(<span class="hljs-string">'likes'</span>), [<span class="hljs-string">'Traveling'</span>, <span class="hljs-string">'Money'</span>, <span class="hljs-string">'Robin'</span>]) === <span class="hljs-literal">true</span>; <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h2 id="une-calculatrice-en-notation-pr-fixe">Une calculatrice en notation préfixe</h2>

            </div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Une propriété d’un objet peut être un nombre, une chaîne, un
tableau, un objet, et même une fonction.  Voici un objet de
fonctions arithmétiques qui prennent toutes en argument une liste
de nombres (vue comme une pile), et retournent un nombre.
<strong>Complétez</strong> cet objet avec les fonctions suivantes:</p>
<ul>
<li>cube: x → x³</li>
<li>fibo: n → Fibonacci(n)</li>
<li>minus: x y → x - y</li>
<li>times: x y → x * y</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> functions = {
  square: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(stack)</span> </span>{ <span class="hljs-keyword">return</span> square(stack.pop()); },
  cube: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(stack)</span> </span>{ <span class="hljs-keyword">return</span> cube(stack.pop()); },
  fibo: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(stack)</span> </span>{ <span class="hljs-keyword">return</span> fibo(stack.pop()); },
  plus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(stack)</span> </span>{ <span class="hljs-keyword">return</span> stack.pop() + stack.pop(); },
  minus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(stack)</span> </span>{ <span class="hljs-keyword">return</span> stack.pop() - stack.pop(); },
  times: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(stack)</span> </span>{ <span class="hljs-keyword">return</span> stack.pop() * stack.pop(); },
};</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>La fonction <code>polish</code> prend une chaîne qui représente une expression
arithmétique en notation polonaise (préfixe) et retourne le
résultat.  Pour ce faire, elle découpe la chaîne suivant les
espaces pour former un tableau d’arguments, puis appelle <code>polish1</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">polish</span><span class="hljs-params">(str)</span> </span>{
  <span class="hljs-keyword">return</span> polish1(str.split(<span class="hljs-string">' '</span>), []);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>La fonction <code>polish1</code> traite les arguments un à un.  Si c’est une
fonction de l’objet <code>fonctions</code>, elle appelle cette fonction sur la
pile.  Sinon, elle transforme l’argument en nombre (avec
<code>parseInt</code>) et l’ajoute à la pile.
<strong>Écrivez</strong> cette fonction.  <em>Conseil</em> : faites une récursion sur
le dernier élément de la liste <code>args</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">polish1</span><span class="hljs-params">(args, stack)</span> </span>{
  <span class="hljs-keyword">if</span> (args.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> stack.pop();

  <span class="hljs-keyword">var</span> a = args.pop();

  <span class="hljs-keyword">if</span> (a <span class="hljs-keyword">in</span> functions) {
    stack.push(functions[a](stack));
    <span class="hljs-keyword">return</span> polish1(args, stack);
  } <span class="hljs-keyword">else</span> {
    stack.push(<span class="hljs-built_in">parseInt</span>(a, <span class="hljs-number">10</span>));
    <span class="hljs-keyword">return</span> polish1(args, stack);
  }
}

polish(<span class="hljs-string">'2'</span>) === <span class="hljs-number">2</span>; <span class="hljs-comment">//:</span>
polish(<span class="hljs-string">'plus 2 3'</span>) === <span class="hljs-number">5</span>; <span class="hljs-comment">//:</span>
polish(<span class="hljs-string">'minus 2 3'</span>) === -<span class="hljs-number">1</span>; <span class="hljs-comment">//:</span>
polish(<span class="hljs-string">'plus 2 times 3 6'</span>) === <span class="hljs-number">20</span>; <span class="hljs-comment">//:</span>
polish(<span class="hljs-string">'cube plus 2 fibo 3'</span>) === cube(<span class="hljs-number">2</span> + fibo(<span class="hljs-number">3</span>)); <span class="hljs-comment">//:</span></pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h2 id="bonus">Bonus</h2>
<p>Quelques questions pour aller plus loin :</p>
<ul>
<li>Avez-vous écrit la fonction qui calcule les nombres de Fibonacci
récursivement <em>et</em> itérativement ?</li>
<li>Même question pour les fonctions <code>eq</code>, <code>accum</code>, et <code>range</code>.</li>
<li>Utilisez la fonction <code>range</code> pour définir <code>accum</code>.</li>
<li>Écrivez une version de la fonction <code>eq</code> qui retourne vrai pour
des tableaux de tableaux (égalité profonde).</li>
</ul>
<p>À noter qu’il n’y a pas d’optimisation de l’appel terminal en
JavaScript, donc les fonctions récursives sont limitées par la
taille de la pile.  Pouvez-vous trouver la taille de la pile de
votre navigateur ?</p>

            </div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
